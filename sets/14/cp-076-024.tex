\begin{align*}
V_o &= -Av_i \\
V_x &= V_2\left(\frac{R_4}{R_4+R_2}\right) \\
\end{align*}
\begin{align*}
I = \frac{V_x+v_i+Av_i}{R_3} \\
\end{align*}
\begin{align*}
-V_x -v_i +I(R_3) -Av_i &= 0\\
-V_1 +I(R_1) +I(R_3) -Av_i &= 0\\
-V_1 +I(R_1) +v_i +V_x &= 0\\
\end{align*}
\begin{align*}
-V_1 +\left(\frac{R_1}{R_3}+1\right)\left(v_i(1+A) +V_x\right) &= 0\\
-V_1 +\left(\frac{R_1}{R_3}+1\right)\left(v_i(1+A) +V_2\left(\frac{R_4}{R_4+R_2}\right)\right) &= 0\\
\end{align*}
\begin{align*}
v_i(1+A) &= \dfrac{v_i}{\left(\dfrac{R_1}{R_3}+1\right)} -V_2\left(\frac{R_4}{R_4+R_2}\right)\\
V_o\frac{-(1+A)}{A} &= \dfrac{V_1}{\dfrac{R_1}{R_3} +1} -V_2\left(\frac{R_4}{R_4+R_2}\right)\\
V_o &= \left(-\frac{A}{1+A}\right) \left(V_1\frac{R_3}{R_1+R_3} -V_2\frac{R_4}{R_4+R}\right)\\
\end{align*}
\begin{gather*}
	\hlbox{$V_o = V_2-V_1$}
\end{gather*}